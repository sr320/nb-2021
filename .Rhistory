install.packages("usethis")
library(usethis)
use_git_config(user.name = “Steven Roberts”, user.email = “sr320@uw.edu”)
library(usethis)
use_git_config(user.name = “Steven Roberts”, user.email = “sr320@uw.edu”)
use_git_config(user.name = "Steven Roberts", user.email = "sr320@uw.edu")
library(tidyverse)
spur <- read.csv("../analyses/Cg-ProteinsSpur5.0_blastx.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE) %>%
select(V1, V2, V11)
head(spur)
ncbiP <- read.csv("../data/NcbiProteinEchinobaseGene_Spur.txt", header = FALSE, sep="\t")
head(ncbiP)
library(fuzzyjoin)
#spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
spur %>% stringdist_inner_join(ncbiP, by = "V2", max_dist = 2)
#spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
betterspur <- spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
write_tsv(
betterspur,
"../analyses/Spur-blastx-genesym.tab"
)
write_tsv(
betterspur,
"../analyses/Spur-blastx-LOC.tab"
)
View(betterspur)
write_tsv(
betterspur,
"../analyses/Spur-blastx-LOCsym.tab"
)
library(tidyverse)
cdslist <- read.csv("../analyses/GCF_000297895_cdslist.tab", header = FALSE)
uniprot <- read.csv("../analyses/Cg-blastx-sp.tab.txt", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
View(uniprot)
suniprot <- read.csv("../analyses/Cg-uniprot_blastx_02.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
cdslist <- read.csv("../analyses/GCF_000297895_cdslist.tab", header = FALSE)
uniprot <- read.csv("../analyses/Cg-blastx-sp.tab.txt", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
spurLOC <- read.csv("../analyses/Spur-blastx-LOCsym.tab", header = FALSE)
View(spurLOC)
spurLOC <- read.csv("../analyses/Spur-blastx-LOCsym.tab", header = TRUE, sep="\t")
View(spurLOC)
spur <- read.csv("../analyses/Cg-ProteinsSpur5.0_blastx.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
View(spur)
View(spurLOC)
spurn <- read.csv("../analyses/Cg-SpurCDS_blastn.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
dmel <- read.csv("../analyses/Cg-dmel-gene_blastn_02.tab", header = FALSE, sep="\t")  %>%
distinct(V1, .keep_all = TRUE)
celsym <- read.csv("../analyses/Cg_Ce-genesym.tab", header = FALSE, sep="\t")
comb <- left_join(cdslist, uniprot, by = "V1"  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2"))
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2"))
View(comb)
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2")) %>%
select(V1, V2.x, V3.x, V2.x.x, V11, V1.y, V3.y, V4.x, V2.y.y, V3.x.x,
V1.y.y, V3.y.y, V4.y) %>%
rename(cdsID = V1, uniprot = V2.x, u_ev = V3.x, spurAcc
= V2.xx, s_ev = V11, spID02 = V1.y, ecb = V3.y, spu_sym = V4.x, dmel = V2.y.y, dmel_ev = V3.x.x, cel_ID = V1.y.y, cel_ev = V3.y.y, cel_sym = V4.y)
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2")) %>%
select(V1, V2.x, V3.x, V2.x.x, V11, V1.y, V3.y, V4.x, V2.y.y, V3.x.x,
V1.y.y, V3.y.y, V4.y) %>%
rename(cdsID = V1, uniprot = V2.x, u_ev = V3.x, spurAcc
= V2.x.x, s_ev = V11, spID02 = V1.y, ecb = V3.y, spu_sym = V4.x, dmel = V2.y.y, dmel_ev = V3.x.x, cel_ID = V1.y.y, cel_ev = V3.y.y, cel_sym = V4.y)
View(comb)
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2")) %>%
select(V1, V2.x, V3.x, V2.x.x, V11, V1.y, V3.y, V4.x, V2.y.y, V3.x.x,
V1.y.y, V3.y.y, V4.y) %>%
rename(cdsID = V1, uniprot = V2.x, u_ev = V3.x, spurAcc
= V2.x.x, s_ev = V11, spID02 = V1.y, sp_ecb = V3.y, sp_sym = V4.x, dmel = V2.y.y, dmel_ev = V3.x.x, cel_ID = V1.y.y, cel_ev = V3.y.y, cel_sym = V4.y)
giles <- read.csv("../data/bestblast_/bestblast.tab", header = TRUE, sep = "\t") %>%
select(ID, HitAcc, HitDesc, E.Value)
comb_g <- left_join(comb, giles, by = c("cdsID" = "ID"))
loc <- read.csv("../data/bestblast_/LOC_seqID_key.tab", header = FALSE, sep = "\t")
loc_dt <- left_join(loc, comb_g, by = c("V1" = "cdsID"))
View(loc_dt)
write_tsv(
loc_dt,
"../analyses/Cg-annot-join-V1.2.tab"
)
View(loc_dt)
top <- read.csv("../data/topmarker_bla_mitov7_top10perCluster.txt", header = TRUE, sep="\t")
View(top)
View(loc_dt)
top <- read.csv("../data/topmarker_bla_mitov7_top10perCluster.txt", header = TRUE, sep = "\t")
annot <- read.csv("../analyses/Cg-annot-join-V1.2.tab", header = TRUE, sep = "\t")
View(annot)
top.annotv1.1 <- left_join(top, annot, by = c("gene_id" = "V2"))
write_tsv(
top.annotv1.1,
"../analyses/top.annotv1.2.tab"
)
top.annotv1.2 <- left_join(top, annot, by = c("gene_id" = "V2"))
write_tsv(
top.annotv1.2,
"../analyses/top.annotv1.2.tab"
)
View(top.annotv1.2)
