install.packages("usethis")
library(usethis)
use_git_config(user.name = “Steven Roberts”, user.email = “sr320@uw.edu”)
library(usethis)
use_git_config(user.name = “Steven Roberts”, user.email = “sr320@uw.edu”)
use_git_config(user.name = "Steven Roberts", user.email = "sr320@uw.edu")
library(tidyverse)
spur <- read.csv("../analyses/Cg-ProteinsSpur5.0_blastx.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE) %>%
select(V1, V2, V11)
head(spur)
ncbiP <- read.csv("../data/NcbiProteinEchinobaseGene_Spur.txt", header = FALSE, sep="\t")
head(ncbiP)
library(fuzzyjoin)
#spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
spur %>% stringdist_inner_join(ncbiP, by = "V2", max_dist = 2)
#spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
betterspur <- spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
write_tsv(
betterspur,
"../analyses/Spur-blastx-genesym.tab"
)
write_tsv(
betterspur,
"../analyses/Spur-blastx-LOC.tab"
)
View(betterspur)
write_tsv(
betterspur,
"../analyses/Spur-blastx-LOCsym.tab"
)
library(tidyverse)
cdslist <- read.csv("../analyses/GCF_000297895_cdslist.tab", header = FALSE)
uniprot <- read.csv("../analyses/Cg-blastx-sp.tab.txt", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
View(uniprot)
suniprot <- read.csv("../analyses/Cg-uniprot_blastx_02.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
cdslist <- read.csv("../analyses/GCF_000297895_cdslist.tab", header = FALSE)
uniprot <- read.csv("../analyses/Cg-blastx-sp.tab.txt", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
spurLOC <- read.csv("../analyses/Spur-blastx-LOCsym.tab", header = FALSE)
View(spurLOC)
spurLOC <- read.csv("../analyses/Spur-blastx-LOCsym.tab", header = TRUE, sep="\t")
View(spurLOC)
spur <- read.csv("../analyses/Cg-ProteinsSpur5.0_blastx.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
View(spur)
View(spurLOC)
spurn <- read.csv("../analyses/Cg-SpurCDS_blastn.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
dmel <- read.csv("../analyses/Cg-dmel-gene_blastn_02.tab", header = FALSE, sep="\t")  %>%
distinct(V1, .keep_all = TRUE)
celsym <- read.csv("../analyses/Cg_Ce-genesym.tab", header = FALSE, sep="\t")
comb <- left_join(cdslist, uniprot, by = "V1"  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2"))
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2"))
View(comb)
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2")) %>%
select(V1, V2.x, V3.x, V2.x.x, V11, V1.y, V3.y, V4.x, V2.y.y, V3.x.x,
V1.y.y, V3.y.y, V4.y) %>%
rename(cdsID = V1, uniprot = V2.x, u_ev = V3.x, spurAcc
= V2.xx, s_ev = V11, spID02 = V1.y, ecb = V3.y, spu_sym = V4.x, dmel = V2.y.y, dmel_ev = V3.x.x, cel_ID = V1.y.y, cel_ev = V3.y.y, cel_sym = V4.y)
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2")) %>%
select(V1, V2.x, V3.x, V2.x.x, V11, V1.y, V3.y, V4.x, V2.y.y, V3.x.x,
V1.y.y, V3.y.y, V4.y) %>%
rename(cdsID = V1, uniprot = V2.x, u_ev = V3.x, spurAcc
= V2.x.x, s_ev = V11, spID02 = V1.y, ecb = V3.y, spu_sym = V4.x, dmel = V2.y.y, dmel_ev = V3.x.x, cel_ID = V1.y.y, cel_ev = V3.y.y, cel_sym = V4.y)
View(comb)
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2")) %>%
select(V1, V2.x, V3.x, V2.x.x, V11, V1.y, V3.y, V4.x, V2.y.y, V3.x.x,
V1.y.y, V3.y.y, V4.y) %>%
rename(cdsID = V1, uniprot = V2.x, u_ev = V3.x, spurAcc
= V2.x.x, s_ev = V11, spID02 = V1.y, sp_ecb = V3.y, sp_sym = V4.x, dmel = V2.y.y, dmel_ev = V3.x.x, cel_ID = V1.y.y, cel_ev = V3.y.y, cel_sym = V4.y)
giles <- read.csv("../data/bestblast_/bestblast.tab", header = TRUE, sep = "\t") %>%
select(ID, HitAcc, HitDesc, E.Value)
comb_g <- left_join(comb, giles, by = c("cdsID" = "ID"))
loc <- read.csv("../data/bestblast_/LOC_seqID_key.tab", header = FALSE, sep = "\t")
loc_dt <- left_join(loc, comb_g, by = c("V1" = "cdsID"))
View(loc_dt)
write_tsv(
loc_dt,
"../analyses/Cg-annot-join-V1.2.tab"
)
View(loc_dt)
top <- read.csv("../data/topmarker_bla_mitov7_top10perCluster.txt", header = TRUE, sep="\t")
View(top)
View(loc_dt)
top <- read.csv("../data/topmarker_bla_mitov7_top10perCluster.txt", header = TRUE, sep = "\t")
annot <- read.csv("../analyses/Cg-annot-join-V1.2.tab", header = TRUE, sep = "\t")
View(annot)
top.annotv1.1 <- left_join(top, annot, by = c("gene_id" = "V2"))
write_tsv(
top.annotv1.1,
"../analyses/top.annotv1.2.tab"
)
top.annotv1.2 <- left_join(top, annot, by = c("gene_id" = "V2"))
write_tsv(
top.annotv1.2,
"../analyses/top.annotv1.2.tab"
)
View(top.annotv1.2)
library(tidyverse)
S3 <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S3_ Morula_Cluster16.txt", header = TRUE, sep="\t")
View(S3)
load("../analyses/top.annotv1.2.tab")
top1.2 <- read.csv("../analyses/top.annotv1.2.tab", header = TRUE, sep="\t")
View(top1.2)
left_join(S3, )
left_join(S3, top1.2, by = c("Row.names" ="gene_id"))
left_join(S3, top1.2, by = c("Row.names" ="sp_sym"))
S3_top.2 <-left_join(S3, top1.2, by = c("Row.names" ="sp_sym"))
S3_top1.2 <-left_join(S3, top1.2, by = c("Row.names" ="sp_sym"))
View(S3_top1.2)
write_tsv(
S3_top1.2,
"../analyses/S3_top1.2.tab"
)
write_tsv(
S3_top1.2,
"../analyses/S3_top1.2.tsv"
)
S4 <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S4_ Morula_Cluster20.txt", header = TRUE, sep="\t")
View(S4)
View(S4)
S4_top1.2 <-left_join(S4, top1.2, by = c("Row.names" ="sp_sym"))
View(S4_top1.2)
write_tsv(
S4_top1.2,
"../analyses/S4_top1.2.tsv"
)
S7mor <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_morula.txt", header = TRUE, sep="\t")
View(S7mor)
S7mor_top1.2 <- left_join(S7mor, top1.2, by = c("Row.names" ="sp_sym"))
View(S7mor_top1.2)
write_tsv(
S7mor_top1.2,
"../analyses/S7mor_top1.2.tsv"
)
S7eb <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_early_blastula.txt", header = TRUE, sep="\t")
S7eb_top1.2 <- left_join(S7eb, top1.2, by = c("Row.names" ="sp_sym"))
write_tsv(
S7eb_top1.2,
"../analyses/S7eb_top1.2.tsv"
)
View(S7eb_top1.2)
S7hb <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_hatched_blastula.txt", header = TRUE, sep="\t")
S7hb_top1.2 <- left_join(S7hb, top1.2, by = c("Row.names" ="sp_sym"))
write_tsv(
S7hb_top1.2,
"../analyses/S7hb_top1.2.tsv"
)
S7mb <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_mesenchyme_blastula.txt", header = TRUE, sep="\t")
S7mb_top1.2 <- left_join(S7mb, top1.2, by = c("Row.names" ="sp_sym"))
write_tsv(
S7mb_top1.2,
"../analyses/S7mb_top1.2.tsv"
)
View(S7mb_top1.2)
S7eg <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_early_gastrula.txt", header = TRUE, sep="\t")
S7eg_top1.2 <- left_join(S7eg, top1.2, by = c("Row.names" ="sp_sym"))
write_tsv(
S7eg_top1.2,
"../analyses/S7eg_top1.2.tsv"
)
View(S7eb_top1.2)
S7lg <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_Late_gastrula.txt", header = TRUE, sep="\t")
S7lg_top1.2 <- left_join(S7lg, top1.2, by = c("Row.names" ="sp_sym"))
write_tsv(
S7lg_top1.2,
"../analyses/S7lg_top1.2.tsv"
)
View(S7lg_top1.2)
View(S7eb)
library(tidyverse)
cdslist <- read.csv("../analyses/GCF_000297895_cdslist.tab", header = FALSE)
uniprot <- read.csv("../analyses/Cg-uniprot_blastx.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
uniprot <- read.csv("../analyses/Cg-uniprot_blastx_02.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
dmel <- read.csv("../analyses/Cg-dmel-gene_blastn.tab", header = FALSE, sep="\t")  %>%
distinct(V1, .keep_all = TRUE)
library(tidyverse)
spur <- read.csv("../analyses/Cg-blastx-spur-nev.tab", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
head(spur)
ncbiP <- read.csv("../data/NcbiProteinEchinobaseGene_Spur.txt", header = FALSE, sep="\t")
head(ncbiP)
library(fuzzyjoin)
betterspur <- spur %>% fuzzy_inner_join(ncbiP, by = "V2", match_fun = str_detect)
write_tsv(
betterspur,
"../analyses/Spur-blastx-LOCsym.tab"
)
library(tidyverse)
cdslist <- read.csv("../analyses/GCF_000297895_cdslist.tab", header = FALSE)
uniprot <- read.csv("../analyses/Cg-blastx-sp.tab.txt", header = FALSE, sep="\t") %>%
distinct(V1, .keep_all = TRUE)
spurLOC <- read.csv("../analyses/Spur-blastx-LOCsym.tab", header = TRUE, sep="\t")
dmel <- read.csv("../analyses/Cg-dmel-gene_blastn_02.tab", header = FALSE, sep="\t")  %>%
distinct(V1, .keep_all = TRUE)
celsym <- read.csv("../analyses/Cg_Ce-genesym.tab", header = FALSE, sep="\t")
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2")) %>%
select(V1, V2.x, V3.x, V2.x.x, V11, V1.y, V3.y, V4.x, V2.y.y, V3.x.x,
V1.y.y, V3.y.y, V4.y) %>%
rename(cdsID = V1, uniprot = V2.x, u_ev = V3.x, spurAcc
= V2.x.x, s_ev = V11, spID02 = V1.y, sp_ecb = V3.y, sp_sym = V4.x, dmel = V2.y.y, dmel_ev = V3.x.x, cel_ID = V1.y.y, cel_ev = V3.y.y, cel_sym = V4.y)
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2"))
View(comb)
View(uniprot)
View(spurLOC)
comb <- left_join(cdslist, uniprot, by = "V1")  %>%
left_join(spurLOC, by = c("V1" ="V1.x")) %>%
left_join(dmel, by = "V1") %>%
left_join(celsym, by = c("V1" = "V2")) %>%
select(V1, V2.x, V3.x, V2.x.x, V3.x.x, V1.y, V3.y, V4.x, V2.y.y, V3.y.y,
V1.y.y, V3, V4.y) %>%
rename(cdsID = V1, uniprot = V2.x, u_ev = V3.x, spurAcc
= V2.x.x, s_ev = V3.x.x, spID02 = V1.y, sp_ecb = V3.y, sp_sym = V4.x, dmel = V2.y.y, dmel_ev = V3.y.y, cel_ID = V1.y.y, cel_ev = V3, cel_sym = V4.y)
View(comb)
giles <- read.csv("../data/bestblast_/bestblast.tab", header = TRUE, sep = "\t") %>%
select(ID, HitAcc, HitDesc, E.Value)
comb_g <- left_join(comb, giles, by = c("cdsID" = "ID"))
loc <- read.csv("../data/bestblast_/LOC_seqID_key.tab", header = FALSE, sep = "\t")
loc_dt <- left_join(loc, comb_g, by = c("V1" = "cdsID"))
write_tsv(
loc_dt,
"../analyses/Cg-annot-join-V1.3.tab"
)
top <- read.csv("../data/topmarker_bla_mitov7_top10perCluster.txt", header = TRUE, sep = "\t")
annot <- read.csv("../analyses/Cg-annot-join-V1.3.tab", header = TRUE, sep = "\t")
top.annotv1.3 <- left_join(top, annot, by = c("gene_id" = "V2"))
write_tsv(
top.annotv1.3,
"../analyses/top.annotv1.3.tab"
)
top1.3 <- read.csv("../analyses/top.annotv1.3.tab", header = TRUE, sep="\t")
S3 <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S3_ Morula_Cluster16.txt", header = TRUE, sep="\t")
top1.3 <- read.csv("../analyses/top.annotv1.3.tab", header = TRUE, sep="\t")
S3_top1.3 <-left_join(S3, top1.3, by = c("Row.names" ="sp_sym"))
write_tsv(
S3_top1.3,
"../analyses/S3_top1.3.tsv"
)
S4 <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S4_ Morula_Cluster20.txt", header = TRUE, sep="\t")
S4_top1.3 <-left_join(S4, top1.3, by = c("Row.names" ="sp_sym"))
write_tsv(
S4_top1.3,
"../analyses/S4_top1.3.tsv"
)
S7mor <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_morula.txt", header = TRUE, sep="\t")
S7mor_top1.3 <- left_join(S7mor, top1.3, by = c("Row.names" ="sp_sym"))
write_tsv(
S7mor_top1.3,
"../analyses/S7mor_top1.3.tsv"
)
S7eb <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_early_blastula.txt", header = TRUE, sep="\t")
S7eb_top1.3 <- left_join(S7eb, top1.3, by = c("Row.names" ="sp_sym"))
write_tsv(
S7eb_top1.3,
"../analyses/S7eb_top1.3.tsv"
)
S7hb <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_hatched_blastula.txt", header = TRUE, sep="\t")
S7hb_top1.3 <- left_join(S7hb, top1.3, by = c("Row.names" ="sp_sym"))
write_tsv(
S7hb_top1.3,
"../analyses/S7hb_top1.3.tsv"
)
S7mb <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_mesenchyme_blastula.txt", header = TRUE, sep="\t")
S7mb_top1.3 <- left_join(S7mb, top1.3, by = c("Row.names" ="sp_sym"))
write_tsv(
S7mb_top1.3,
"../analyses/S7mb_top1.3.tsv"
)
S7eg <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_early_gastrula.txt", header = TRUE, sep="\t")
S7eg_top1.3 <- left_join(S7eg, top1.3, by = c("Row.names" ="sp_sym"))
write_tsv(
S7eg_top1.3,
"../analyses/S7eg_top1.3.tsv"
)
S7lg <- read.csv("../data/fwddev191528revisedsupplementaryfile/Table S7_ Cluster 20 Markers_Late_gastrula.txt", header = TRUE, sep="\t")
S7lg_top1.3 <- left_join(S7lg, top1.3, by = c("Row.names" ="sp_sym"))
write_tsv(
S7lg_top1.3,
"../analyses/S7lg_top1.3.tsv"
)
install.packages("rmarkdown")
