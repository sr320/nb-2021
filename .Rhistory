tileit <- function(object, win.size=100, step.size=100, cov.bases=5) {
g.meth <- as(object,"GRanges")
chrs <- as.character(unique(seqnames(g.meth)))
grl <- split(g.meth, seqnames(g.meth))
max.length <- max(end(grl))
numTiles <- floor((max.length - (win.size - step.size))/step.size) + 1
starts <- unlist(sapply(numTiles,function(x) 1+0:(x-1)*step.size))
ranges <- IRanges(start=starts, width=rep(win.size,length(starts)))
all.wins <- GRanges(seqnames=Rle(chrs, numTiles), ranges=ranges)
rcounts <- regionCounts(object, all.wins, 0, strand.aware=FALSE)
rcounts.filtered <- rcounts[rcounts$coverage >= cov.bases, ]
return(rcounts.filtered)
}
# Code to run function on methylKitList
new.list <- lapply(myobj_01, tileit)
myobj.tiled <- new("methylRawList", new.list, treatment=myobj_01@treatment)
filtered.myobj_tile=filterByCoverage(myobj.tiled,lo.count=5,lo.perc=NULL,
hi.count=100,hi.perc=NULL)
meth_filter_tile=unite(filtered.myobj_tile, destrand=TRUE)
clusterSamples(meth_filter_tile, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter_tile,screeplot=FALSE, adj.lim=c(0.0004,0.1),
scale=TRUE,center=TRUE,comp=c(1,2),transpose=TRUE,sd.filter=TRUE,
sd.threshold=0.5,filterByQuantile=TRUE,obj.return=FALSE)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=25,qvalue=0.05)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=25,qvalue=0.1)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=25,qvalue=1)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=5,qvalue=1)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=5,qvalue=.01)
getMethylationStats(myobj_01[[2]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj_01[[5]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj_01[[1-8]],plot=TRUE,both.strands=FALSE)
getMethylationStats(myobj_01[[3]],plot=TRUE,both.strands=FALSE)
getMethylationStats(filtered.myobj[[3]],plot=TRUE,both.strands=FALSE)
getCoverageStats(filtered.myobj[[2]],plot=TRUE,both.strands=FALSE)
filtered.myobj=filterByCoverage(myobj_01,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, min.per.group=3L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
myDiff=calculateDiffMeth(meth_filter,mc.cores=8)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=5,qvalue=.01)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=25,qvalue=.01)
filtered.myobj=filterByCoverage(myobj_01,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, min.per.group=2L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
myDiff=calculateDiffMeth(meth_filter,mc.cores=8)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=25,qvalue=.01)
View(myDiff25p.hypo)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=10,qvalue=.01)
View(myDiff25p)
getCorrelation(meth,plot=TRUE)
getCorrelation(filtered.myobj,plot=TRUE)
head(filtered.myobj)
getCorrelation(filtered.myobj,plot=TRUE)
myobj_lowCov = methRead(sb.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly="v081",
treatment = c(0,0,0,0,1,1,1,1)),
myobj_lowCov = methRead(sb.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly="v081",
treatment = c(0,0,0,0,1,1,1,1),
context="CpG",
mincov = 3
)
myobj_lowCov = processBismarkAln(sb.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly="v081",
treatment = c(0,0,0,0,1,1,1,1),
context="CpG",
mincov = 3
)
knitr::opts_chunk$set(echo = TRUE)
cov.list=list('../data/1_ATCACG.CpG_report.merged_CpG_evidence.cov',
'../data/2_CGATGT.CpG_report.merged_CpG_evidence.cov',
'../data/3_TTAGGC.CpG_report.merged_CpG_evidence.cov',
'../data/4_TGACCA.CpG_report.merged_CpG_evidence.cov',
'../data/5_ACAGTG.CpG_report.merged_CpG_evidence.cov',
'../data/6_GCCAAT.CpG_report.merged_CpG_evidence.cov',
'../data/7_CAGATC.CpG_report.merged_CpG_evidence.cov',
'../data/8_ACTTGA.CpG_report.merged_CpG_evidence.cov'
)
library(methylKit)
myobj_02 = methyread(location = cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly = "v081",
read.context="CpG",
mincov=2,
pipeline = "bismarkCoverage",
treatment = c(0,0,0,0,1,1,1,1)
)
myobj_02 = methRead(location = cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly = "v081",
read.context="CpG",
mincov=2,
pipeline = "bismarkCoverage",
treatment = c(0,0,0,0,1,1,1,1)
)
myobj_02 = methRead(location = cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly = "v081",
context="CpG",
mincov=2,
pipeline = "bismarkCoverage",
treatment = c(0,0,0,0,1,1,1,1)
)
getMethylationStats(myobj_02[[3]],plot=TRUE,both.strands=FALSE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, min.per.group=2L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, min.per.group=3L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=5,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group = 1L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=2,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group = 1L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=2,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group=1L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=2,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group=4L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=2,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group=1L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=2,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group=1L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_01,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, min.per.group=2L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
filtered.myobj=filterByCoverage(myobj_01,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, min.per.group=3L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
myobj_lowCov = methRead(cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly="v081",
treatment = c(0,0,0,0,1,1,1,1),
context="CpG",
mincov = 3
)
myobj_lowCov = methRead(cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly="v081",
treatment = c(0,0,0,0,1,1,1,1),
context="CpG",
mincov = 3
)
cov.list=list('../data/1_ATCACG.CpG_report.merged_CpG_evidence.cov',
'../data/2_CGATGT.CpG_report.merged_CpG_evidence.cov',
'../data/3_TTAGGC.CpG_report.merged_CpG_evidence.cov',
'../data/4_TGACCA.CpG_report.merged_CpG_evidence.cov',
'../data/5_ACAGTG.CpG_report.merged_CpG_evidence.cov',
'../data/6_GCCAAT.CpG_report.merged_CpG_evidence.cov',
'../data/7_CAGATC.CpG_report.merged_CpG_evidence.cov',
'../data/8_ACTTGA.CpG_report.merged_CpG_evidence.cov'
)
myobj_lowCov = methRead(cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly="v081",
treatment = c(0,0,0,0,1,1,1,1),
context="CpG",
mincov = 3
)
myobj_lowCov = methRead(cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly="v081",
treatment = c(0,0,0,0,1,1,1,1),
pipeline = "bismarkCoverage",
context="CpG",
mincov = 3
)
tiles = tileMethylCounts(myobj_lowCov,win.size=1000,step.size=1000,cov.bases = 10)
head(tiles[[1]],3)
save(tiles, file = "../analyses/tiles_01")
getMethylationStats(tiles[[3]],plot=TRUE,both.strands=FALSE)
tiles_filter=unite(tiles, min.per.group=3L, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
tiles_filter=unite(tiles, min.per.group=4L, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
tiles_filter=unite(tiles, min.per.group=4L, destrand=FALSE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
tiles_filter=unite(tiles, min.per.group=1L, destrand=FALSE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
tiles_filter=unite(tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles,lo.count=20,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles,lo.count=50,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles,lo.count=3,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles,lo.count=10,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
tiles02 = tileMethylCounts(myobj_lowCov,win.size=1000,step.size=1000,cov.bases = 5)
getMethylationStats(tiles[[4]],plot=TRUE,both.strands=FALSE)
save(tiles02, file = "../analyses/tiles_02")
getMethylationStats(tiles02[[4]],plot=TRUE,both.strands=FALSE)
filtered.tiles=filterByCoverage(tiles02,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles02,lo.count=6,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles02,lo.count=10,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles02,lo.count=10,lo.perc=NULL,
hi.count=100,hi.perc=NULL)
tiles_filter=unite(filtered.tiles, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles02,lo.count=10,lo.perc=NULL,
hi.count=100,hi.perc=NULL)
tiles_filter=unite(filtered.tiles, min.per.group=1L, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles02,lo.count=NULL,lo.perc=NULL,
hi.count=100,hi.perc=NULL)
tiles_filter=unite(filtered.tiles, min.per.group=1L, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
filtered.tiles=filterByCoverage(tiles02,lo.count=NULL,lo.perc=NULL,
hi.count=100,hi.perc=NULL)
tiles_filter=unite(filtered.tiles, min.per.group=3L, destrand=TRUE)
clusterSamples(tiles_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(tiles_filter)
myDiff.tile=calculateDiffMeth(tiles02,mc.cores=8)
myDiff.tile=calculateDiffMeth(tiles,mc.cores=8)
getMethylationStats(myobj_01[[3]],plot=TRUE,both.strands=FALSE)
filtered.myobj=filterByCoverage(myobj_01,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
library(methylKit)
filtered.myobj=filterByCoverage(myobj_01,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
load("../analyses/myobj_01")
filtered.myobj=filterByCoverage(myobj_01,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, min.per.group=3L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
myDiff=calculateDiffMeth(meth_filter,mc.cores=8)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=10,qvalue=.01)
bam.list=list('/Volumes/block/wd/061421/1_ATCACG_L001_R1_001_trimmed_bismark_bt2.deduplicated.sorted.bam',
'/Volumes/block/wd/061421/2_CGATGT_L001_R1_001_trimmed_bismark_bt2.deduplicated.sorted.bam',
'/Volumes/block/wd/061421/3_TTAGGC_L001_R1_001_trimmed_bismark_bt2.deduplicated.sorted.bam',
'/Volumes/block/wd/061421/4_TGACCA_L001_R1_001_trimmed_bismark_bt2.deduplicated.sorted.bam',
'/Volumes/block/wd/061421/5_ACAGTG_L001_R1_001_trimmed_bismark_bt2.deduplicated.sorted.bam',
'/Volumes/block/wd/061421/6_GCCAAT_L001_R1_001_trimmed_bismark_bt2.deduplicated.sorted.bam',
'/Volumes/block/wd/061421/7_CAGATC_L001_R1_001_trimmed_bismark_bt2.deduplicated.sorted.bam',
'/Volumes/block/wd/061421/8_ACTTGA_L001_R1_001_trimmed_bismark_bt2.deduplicated.sorted.bam'
)
library(methylKit)
getMethylationStats(myobj_01[[3]],plot=TRUE,both.strands=FALSE)
filtered.myobj=filterByCoverage(myobj_01,lo.count=10,lo.perc=NULL,
hi.count=1000,hi.perc=NULL)
meth_filter=unite(filtered.myobj, min.per.group=3L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
myDiff=calculateDiffMeth(meth_filter,mc.cores=8)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=10,qvalue=.01)
head(filtered.myobj)
getCorrelation(filtered.myobj,plot=TRUE)
cov.list=list('../data/1_ATCACG.CpG_report.merged_CpG_evidence.cov',
'../data/2_CGATGT.CpG_report.merged_CpG_evidence.cov',
'../data/3_TTAGGC.CpG_report.merged_CpG_evidence.cov',
'../data/4_TGACCA.CpG_report.merged_CpG_evidence.cov',
'../data/5_ACAGTG.CpG_report.merged_CpG_evidence.cov',
'../data/6_GCCAAT.CpG_report.merged_CpG_evidence.cov',
'../data/7_CAGATC.CpG_report.merged_CpG_evidence.cov',
'../data/8_ACTTGA.CpG_report.merged_CpG_evidence.cov'
)
load("../analyses/myobj_01")
load("../analyses/myobj_02")
getMethylationStats(myobj_02[[3]],plot=TRUE,both.strands=FALSE)
myobj_02 = methRead(location = cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly = "v081",
context="CpG",
mincov=2,
pipeline = "bismarkCoverage",
treatment = c(0,0,0,0,1,1,1,1)
)
getMethylationStats(myobj_02[[3]],plot=TRUE,both.strands=FALSE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=2,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group=1L, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=2,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
filtered.myobj=filterByCoverage(myobj_02,lo.count=2,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group = 1L, destrand=TRUE)
cov.list=list('../data/1_ATCACG.CpG_report.merged_CpG_evidence.cov',
'../data/2_CGATGT.CpG_report.merged_CpG_evidence.cov',
'../data/3_TTAGGC.CpG_report.merged_CpG_evidence.cov',
'../data/4_TGACCA.CpG_report.merged_CpG_evidence.cov',
'../data/5_ACAGTG.CpG_report.merged_CpG_evidence.cov',
'../data/6_GCCAAT.CpG_report.merged_CpG_evidence.cov',
'../data/7_CAGATC.CpG_report.merged_CpG_evidence.cov',
'../data/8_ACTTGA.CpG_report.merged_CpG_evidence.cov'
)
load ("../analyses/tiles_01")
filtered.myobj=filterByCoverage(tiles,lo.count=3,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group = 1L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
filtered.myobj=filterByCoverage(tiles,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group = 1L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
myDiff=calculateDiffMeth(meth_filter,mc.cores=8)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff25p=getMethylDiff(myDiff,difference=10,qvalue=.01)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff10p=getMethylDiff(myDiff,difference=10,qvalue=.01)
filtered.myobj=filterByCoverage(tiles,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, min.per.group = 4L, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
myDiff=calculateDiffMeth(meth_filter,mc.cores=8)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff10p=getMethylDiff(myDiff,difference=10,qvalue=.01)
filtered.myobj=filterByCoverage(tiles,lo.count=5,lo.perc=NULL,
hi.count=NULL,hi.perc=99.9)
meth_filter=unite(filtered.myobj, destrand=TRUE)
clusterSamples(meth_filter, dist="correlation", method="ward", plot=TRUE)
PCASamples(meth_filter)
myDiff=calculateDiffMeth(meth_filter,mc.cores=8)
# get hyper methylated bases
myDiff25p.hyper=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hyper")
#
# get hypo methylated bases
myDiff25p.hypo=getMethylDiff(myDiff,difference=25,qvalue=0.01,type="hypo")
#
#
# get all differentially methylated bases
myDiff10p=getMethylDiff(myDiff,difference=10,qvalue=.01)
View(myDiff10p)
tiles = tileMethylCounts(myobj_lowCov,win.size=1000,step.size=1000,cov.bases = 10)
myobj_lowCov = methRead(cov.list,
sample.id = list("1","2","3","4","5","6","7","8"),
assembly="v081",
treatment = c(0,0,0,0,1,1,1,1),
pipeline = "bismarkCoverage",
context="CpG",
mincov = 3
)
tiles = tileMethylCounts(myobj_lowCov,win.size=1000,step.size=1000,cov.bases = 10)
head(tiles[[1]],3)
